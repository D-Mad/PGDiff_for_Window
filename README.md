<div align="center">

<h1>PGDiff: Guiding Diffusion Models for Versatile Face Restoration via Partial Guidance</h1>

<div>
    <a href='https://github.com/pq-yang/' target='_blank'>Peiqing Yang</a><sup>1</sup>&emsp;
    <a href='https://shangchenzhou.com/' target='_blank'>Shangchen Zhou</a><sup>1</sup>&emsp;
    <a href='https://scholar.google.com.sg/citations?user=fMXnSGMAAAAJ&hl=en' target='_blank'>Qingyi Tao</a><sup>2</sup>&emsp;
    <a href='https://www.mmlab-ntu.com/person/ccloy/' target='_blank'>Chen Change Loy</a><sup>1</sup>
</div>
<div>
    <sup>1</sup>S-Lab, Nanyang Technological University&emsp; 
    <sup>2</sup>SenseTime Research, Singapore&emsp; 
</div>

<div>
    <h4 align="center">
        • <a href="https://arxiv.org/list/cs.CV/recent" target='_blank'>[arXiv]</a> •
    </h4>
</div>

<img src="assets/teaser.png" width="800px"/>

<strong>PGDiff builds a versatile framework that is applicable to a broad range of face restoration tasks.</strong>

:closed_book: <ins>Supported Applications</ins>

<html>
    <table style="margin-left: auto; margin-right: auto;">
        <tr>
            <td>
                <!--left-->
                <li>Blind Restoration</li> 
                <li>Colorization</li>
                <li>Inpainting</li>
            </td>
            <td>
                <!--right-->
                <li>Reference-based Restoration</li>
                <li>Old Photo Restoration (w/ scratches)</li>
                <li>[TODO] Natural Image Restoration</li>
            </td>
        </tr>
    </table>
</html>

---

</div>

## :postbox: Updates
- 2023.8.23: Since our paper is under review, we will make the codes and models available upon acceptance. Please stay tuned! :bowtie:
- 2023.08.16: This repo is created.

## :circus_tent: Applications

### Blind Restoration

<img src="assets/blind_restoration_1.png" width="800px"/>

<img src="assets/blind_restoration_2.png" width="800px"/>

### Colorization

<img src="assets/colorized_results_1.png" width="800px"/>

<img src="assets/colorized_results_2.png" width="800px"/>

### Inpainting

<img src="assets/inpaint_results_1.png" width="800px"/>

<img src="assets/inpaint_results_2.png" width="800px"/>

### Reference-based Restoration

<img src="assets/ref_results_1.png" width="800px"/>

<img src="assets/ref_results_2.png" width="800px"/>

### Old Photo Restoration

<img src="assets/old_photo_1.png" width="800px"/>

<img src="assets/old_photo_2.png" width="800px"/>

## :phone: Contact
If you have any questions, please feel free to reach out at `peiqingyang99@outlook.com`.

